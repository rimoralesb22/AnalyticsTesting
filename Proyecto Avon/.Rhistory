ensure.loaded("dplyr")
ensure.loaded("cluster")
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.01, .99), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
ClientesTot = read.csv("Valor_clientes.csv")
ClientesTot$CUENTA <- gsub(",","",ClientesTot$CUENTA)
ClientesTot$GANACIA <- gsub(",","",ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- gsub(",","",ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- gsub(",","",ClientesTot$PARTICIPACION)
ClientesTot$GANACIA <- as.numeric(ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- as.numeric(ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- as.numeric(ClientesTot$PARTICIPACION)
Clientes2 = scale(ClientesTot[2:4], center = TRUE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
Clientes5 <- sample_n(na.omit(Clientes3), 1000)
Clientes5 <- cbind(Clientes3,CUENTA=Clientes$CUENTA)
Clientes5 <- data.frame(Clientes5)
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
head(Clientes4)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],3, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],3, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_3Clusters_sample.csv")
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
Clientes2 = scale(ClientesTot[2:4], center = FALSE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
head(Clientes3)
Clientes5 <- cbind(Clientes3,CUENTA=Clientes$CUENTA)
Clientes5 <- data.frame(Clientes5)
#Sacar la muestra
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
source('~/R/Pruebas Locales/AnalyticsTesting/Proyecto Avon/K-means sample rows.r', encoding = 'UTF-8', echo=TRUE)
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
anios=sd(Clientes$GANACIA)
Clientes4$TOTALCAMPANAS_1<-ClientesTot$TOTALCAMPANAS
Clientes5 <- cbind(Clientes3,CUENTA=Clientes$CUENTA,GANANCIAREAL=Clientes$GANACIA,CAMAPANASREAL=Clientes$TOTALCAMPANAS,PARTICIPACIONREAL=Clientes$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
#Sacar la muestra
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
head(Clientes5)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
source('utils.R')
# install the xlsx package, if needed
# and load it into memory
ensure.loaded("dplyr")
ensure.loaded("cluster")
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.01, .99), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
ClientesTot = read.csv("Valor_clientes.csv")
ClientesTot$GANACIA <- gsub(",","",ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- gsub(",","",ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- gsub(",","",ClientesTot$PARTICIPACION)
ClientesTot$CUENTA <- gsub(",","",ClientesTot$CUENTA)
ClientesTot$GANACIA <- as.numeric(ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- as.numeric(ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- as.numeric(ClientesTot$PARTICIPACION)
head(ClientesTot)
Clientes2 = scale(ClientesTot[2:4], center = FALSE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
head(Clientes3)
#Unimos a la matriz la informaciÃ³n original para mantener las variables originales, sin embargo no las tomamos en cuenta para hacer el kmeans.
Clientes5 <- cbind(Clientes3,CUENTA=Clientes$CUENTA,GANANCIAREAL=Clientes$GANACIA,CAMAPANASREAL=Clientes$TOTALCAMPANAS,PARTICIPACIONREAL=Clientes$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
head(Clientes5)
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
cor(Clientes3)
head(Clientes3
)
cor(ClientesTot[2:4])
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
KmeansOptimizado$iter
Clientes2 = scale(ClientesTot[2:4], center = TRUE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
head(Clientes3)
Clientes5 <- cbind(Clientes3,CUENTA=Clientes$CUENTA,GANANCIAREAL=Clientes$GANACIA,CAMAPANASREAL=Clientes$TOTALCAMPANAS,PARTICIPACIONREAL=Clientes$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
head(Clientes5)
#Sacar la muestra
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
##Quitar los outliers de la poblacion
Clientes <- remove_outliers(ClientesTot)
#head(Clientes3)
#Sacar la muestra
Clientes2 <- sample_n(na.omit(Clientes), 1000)
#Estandarizar y Escalar las variables y centrar
GananciaE = scale(Clientes2[,2], center = TRUE, scale = TRUE)
TotCampE = scale(Clientes2[,3], center = TRUE, scale = TRUE)
PartE = scale(Clientes2[,4], center = TRUE, scale = TRUE)
ClientesTot = read.csv("Valor_clientes.csv")
ClientesTot$CUENTA <- gsub(",","",ClientesTot$CUENTA)
ClientesTot$GANACIA <- gsub(",","",ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- gsub(",","",ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- gsub(",","",ClientesTot$PARTICIPACION)
ClientesTot$GANACIA <- as.numeric(ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- as.numeric(ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- as.numeric(ClientesTot$PARTICIPACION)
Clientes <- remove_outliers(ClientesTot)
ClientesTot$CUENTA <- as.numeric(ClientesTot$CUENTA)
Clientes <- remove_outliers(ClientesTot)
source('utils.R')
# install the xlsx package, if needed
# and load it into memory
ensure.loaded("dplyr")
ensure.loaded("cluster")
#Kmeans
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.01, .99), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
ClientesTot = read.csv("Valor_clientes.csv")
ClientesTot$CUENTA <- gsub(",","",ClientesTot$CUENTA)
ClientesTot$GANACIA <- gsub(",","",ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- gsub(",","",ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- gsub(",","",ClientesTot$PARTICIPACION)
ClientesTot$CUENTA <- as.numeric(ClientesTot$CUENTA)
ClientesTot$GANACIA <- as.numeric(ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- as.numeric(ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- as.numeric(ClientesTot$PARTICIPACION)
Clientes2 = scale(ClientesTot[2:4], center = TRUE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
Clientes5 <- cbind(Clientes3,CUENTA=ClientesTot$CUENTA,GANANCIAREAL=ClientesTot$GANACIA,CAMAPANASREAL=ClientesTot$TOTALCAMPANAS,PARTICIPACIONREAL=ClientesTot$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.001, .999), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
ClientesTot = read.csv("Valor_clientes.csv")
ClientesTot$CUENTA <- gsub(",","",ClientesTot$CUENTA)
ClientesTot$GANACIA <- gsub(",","",ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- gsub(",","",ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- gsub(",","",ClientesTot$PARTICIPACION)
ClientesTot$CUENTA <- as.numeric(ClientesTot$CUENTA)
ClientesTot$GANACIA <- as.numeric(ClientesTot$GANACIA)
ClientesTot$TOTALCAMPANAS <- as.numeric(ClientesTot$TOTALCAMPANAS)
ClientesTot$PARTICIPACION <- as.numeric(ClientesTot$PARTICIPACION)
Clientes2 = scale(ClientesTot[2:4], center = TRUE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
Clientes5 <- cbind(Clientes3,CUENTA=ClientesTot$CUENTA,GANANCIAREAL=ClientesTot$GANACIA,CAMAPANASREAL=ClientesTot$TOTALCAMPANAS,PARTICIPACIONREAL=ClientesTot$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
Clientes4 <- sample_n(na.omit(Clientes5), 1000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
Clientes4 <- sample_n(na.omit(Clientes5), 10000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
Clientes2 = scale(ClientesTot[2:4], center = FALSE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
Clientes5 <- cbind(Clientes3,CUENTA=ClientesTot$CUENTA,GANANCIAREAL=ClientesTot$GANACIA,CAMAPANASREAL=ClientesTot$TOTALCAMPANAS,PARTICIPACIONREAL=ClientesTot$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
Clientes4 <- sample_n(na.omit(Clientes5), 10000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],4, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_optimizado_4Clusters_sample.csv")
Clientes2 = scale(ClientesTot[2:4], center = TRUE, scale = TRUE)
Clientes3 <- remove_outliers(Clientes2)
head(Clientes3)
Clientes5 <- cbind(Clientes3,CUENTA=ClientesTot$CUENTA,GANANCIAREAL=ClientesTot$GANACIA,CAMAPANASREAL=ClientesTot$TOTALCAMPANAS,PARTICIPACIONREAL=ClientesTot$PARTICIPACION)
Clientes5 <- data.frame(Clientes5)
Clientes4 <- sample_n(na.omit(Clientes5), 10000)
Errores <-NULL
K_Max   <-9
for (i in 1:K_Max)
{
Errores[i] <- sum(kmeans(Clientes4[1:3], centers=i)$withinss)
}
plot(1:K_Max, Errores, type="b",
xlab="Cantidad de Cluster",
ylab="Suma de error")
Algoritmos         <-c("Hartigan-Wong","Lloyd","Forgy","MacQueen")
CantidadAlgoritmos <-length(Algoritmos) # guarda la cantidad de algoritmos usados
Iteraciones        <-data.frame(Intraclase=numeric(),Algoritmo=character())
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],4, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
for (i in 1:CantidadAlgoritmos)
{
for (ii in 1:100)
{
Modelo      <- kmeans(Clientes4[1:3],5, algorithm = Algoritmos[i])
Iteraciones <- rbind(Iteraciones,
data.frame(Intraclase = Modelo$betweenss,
Algoritmo = Algoritmos[i]))
}
}
Resultados       <- tapply(Iteraciones$Intraclase,Iteraciones$Algoritmo,mean)
Resultados       <-sort(Resultados,decreasing = T)
AlgoritmoGanador <-names(Resultados[1])
KmeansOptimizado <- kmeans(Clientes4[1:3],5, algorithm = AlgoritmoGanador)
Clientes4$Grupo   <-KmeansOptimizado$cluster
plot(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,col=Clientes4$Grupo,cex.axis=.7,cex.lab=.7)
text(Clientes4$TOTALCAMPANAS,Clientes4$GANACIA,
labels=Clientes4$CUENTA,pos=1,col=Clientes4$Grupo,cex=.7)
title(main=paste("Algoritmo ganador:",AlgoritmoGanador),cex.main=.9)
write.csv(Clientes4,"C:/Users/isalopez/Desktop/ganancia_5Clusters_centrado.csv")
